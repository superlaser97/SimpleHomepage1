<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage</title>
    <link href="./style.css" rel="stylesheet">
    <script>
        // ---------------------
        // --- CONFIGURATION ---
        // ---------------------
        const configJson = `{
            "pageTitle": "My Quick Links",
            "notes": [
                { "title": "Project Ideas", "content": "#Project Dashboard#\\nA personal dashboard with weather, to-do list, and quick links. Maybe use a public API.\\n\\n##Technology Choices##\\nIt could be built with SvelteKit or Next.js and deployed on Vercel for free.\\n\\n- Clean, modern design\\n- Utilize glassmorphism\\n- Add a configurable search bar\\n\\n##Design Principles##\\nThe design should be clean, modern, and utilize glassmorphism for a futuristic feel. I should also consider adding a configurable search bar that can search across different engines." },
                { "title": "Shopping List", "content": "#Groceries#\\n- Milk\\n- Bread\\n- Coffee Beans\\n\\n#Hardware#\\n- A new mousepad." },
                { "content": "Remember to deploy the latest changes to Vercel by Friday EOD." }
            ],
            "shortcuts": [
                { "name": "Google", "category": "Search", "url": "https://www.google.com", "icon": "google" },
                { "name": "Bing", "category": "Search", "url": "https://www.bing.com", "icon": "bing" },
                { "name": "YouTube", "category": "Media", "url": "https://www.youtube.com", "icon": "youtube" },
                { "name": "Reddit", "category": "Social & News", "url": "https://www.reddit.com", "icon": "reddit" },
                { "name": "GitHub", "category": "Development", "url": "https://github.com", "icon": "github" },
                { "name": "Vercel", "category": "Development", "url": "https://vercel.com", "icon": "vercel" },
                { "name": "Figma", "category": "Design", "url": "https://www.figma.com", "icon": "figma" }
            ],
            "categoryConfig": {
                "Search": { "color": "sky" },
                "Media": { "color": "red" },
                "Social & News": { "color": "orange" },
                "Development": { "color": "violet" },
                "Design": { "color": "pink" }
            },
            "icons": {
                "google": "M11.99 2C6.47 2 2 6.47 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95a6.36 6.36 0 00-3.98-3.98V6.07h2.95a8.03 8.03 0 013.98 1.93zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2H4.26zm.8 2h2.95a6.36 6.36 0 003.98 3.98v-2.02h-2.95a8.03 8.03 0 01-3.98-1.96zM12.01 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c.09-.66.15-1.32.15-2s-.06-1.34-.15-2h4.68c-.09.66-.15 1.32-.15 2s.06 1.34.15 2zm.25 5.98v-2.02h2.95a8.03 8.03 0 01-3.98 1.96zM17.07 16h2.95a8.03 8.03 0 00-1.93-3.98H16.07v2.02c.36.01.71.02 1 .02z",
                "bing": "M12.83 12.83L10 16.5V7.5l2.83 3.67 4.51-4.51-2.05-2.05a8 8 0 10-8.12 8.12l2.05 2.05 4.51-4.51z",
                "youtube": "M21.58 7.19c-.23-.86-.91-1.54-1.77-1.77C18.25 5 12 5 12 5s-6.25 0-7.81.42c-.86.23-1.54.91-1.77 1.77C2 8.75 2 12 2 12s0 3.25.42 4.81c.23.86.91 1.54 1.77 1.77C5.75 19 12 19 12 19s6.25 0 7.81-.42c.86-.23-1.54-.91-1.77-1.77C22 15.25 22 12 22 12s0-3.25-.42-4.81zM10 15V9l5.2 3-5.2 3z",
                "reddit": "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1.84 13.21c-1.36 0-2.46-1.1-2.46-2.46s1.1-2.46 2.46-2.46 2.46 1.1 2.46 2.46-1.1 2.46-2.46 2.46zm3.68 0c-1.36 0-2.46-1.1-2.46-2.46s1.1-2.46 2.46-2.46 2.46 1.1 2.46 2.46-1.1 2.46-2.46 2.46zm-5.4-5.06c.26-.26.68-.26.94 0l1.62 1.62c.26.26.26.68 0 .94-.26.26-.68.26-.94 0l-1.62-1.62c-.26-.26-.26-.68 0-.94zm6.16 2.56c-.52 1-1.59 1.68-2.8 1.68s-2.28-.68-2.8-1.68c-.14-.28.04-.63.36-.71.32-.08.66.04.79.36.33.63 1.04 1.03 1.65 1.03s1.32-.4 1.65-1.03c.13-.32.47-.44.79-.36.32.08.5.43.36.71z",
                "github": "M12 2C6.477 2 2 6.477 2 12c0 4.419 2.865 8.166 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.455-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.004.071 1.532 1.03 1.532 1.03.891 1.53 2.339 1.088 2.91.832.091-.647.349-1.088.635-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.03-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.269 2.75 1.026A9.564 9.564 0 0112 6.82c.85.004 1.705.115 2.504.336 1.909-1.295 2.747-1.026 2.747-1.026.546 1.378.202 2.398.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.848-2.338 4.695-4.566 4.942.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.578.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z",
                "vercel": "M12 2L2 12l10 10 10-10L12 2z",
                "figma": "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9 18v-6H7V9h2V7a2 2 0 012-2h2v3h-2v2h2v3h-2v3H9z",
                "search": "M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z",
                "edit": "M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",
                "delete": "M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z",
                "add": "M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",
                "copy": "M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z",
                "check": "M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",
                "clipboard": "M19 2h-4.18C14.4 1.15 13.55 0.5 12.5 0.5S10.6 1.15 10.18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h13c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H6V4h2v2h9V4h2v16z"
            }
        }`;

        let config = JSON.parse(configJson);
        let { pageTitle, notes, shortcuts, categoryConfig, icons } = config;

        // --- RENDER DYNAMIC FAVICON ---
        function renderFavicon() {
            const link = document.createElement('link');
            link.rel = 'icon';
            const svgFavicon = `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'><path d='${icons.vercel}'/></svg>`;
            link.href = `data:image/svg+xml,${encodeURIComponent(svgFavicon)}`;
            document.head.appendChild(link);
        }

        // --- RENDER FUNCTIONS ---
        function renderTitle() {
            document.getElementById('page-title').textContent = pageTitle;
            document.title = pageTitle;
        }

        // --- GREETING FUNCTION ---
        function renderGreeter() {
            const greeterContainer = document.getElementById('greeter');
            if (!greeterContainer) return;
            const now = new Date();
            const hour = now.getHours();
            let greeting = 'Welcome!';
            if (hour < 12) {
                greeting = 'Good morning.';
            } else if (hour < 18) {
                greeting = 'Good afternoon.';
            } else {
                greeting = 'Good evening.';
            }
            greeterContainer.textContent = greeting;
        }

        // --- DATE & CLOCK FUNCTIONS ---
        function renderDate() {
            const dateContainer = document.getElementById('date-display');
            if (!dateContainer) return;
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            dateContainer.textContent = now.toLocaleDateString(undefined, options);
        }

        function renderClock() {
            const clockContainer = document.getElementById('clock');
            if (!clockContainer) return;
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            clockContainer.innerHTML = `${hours}:${minutes}:<span class="opacity-60">${seconds}</span>`;
        }
        
        // --- CREATE UI ELEMENTS ---
        function createItemControls(item, type) {
            const controlsContainer = document.createElement('div');
            controlsContainer.className = 'absolute top-1 right-1 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300';

            const editBtn = document.createElement('button');
            editBtn.className = 'p-1 rounded-full bg-gray-300/50 dark:bg-gray-600/50 hover:bg-sky-500/50 dark:hover:bg-sky-400/50 cursor-pointer';
            editBtn.innerHTML = `<svg class="w-4 h-4 text-gray-700 dark:text-gray-200 pointer-events-none" fill="currentColor" viewBox="0 0 24 24"><path d="${icons.edit}"/></svg>`;
            editBtn.onclick = (e) => {
                e.preventDefault(); e.stopPropagation();
                if (type === 'shortcut') showShortcutModal(item);
                else showNoteEditModal(item);
            };

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'p-1 rounded-full bg-gray-300/50 dark:bg-gray-600/50 hover:bg-red-500/50 cursor-pointer';
            deleteBtn.innerHTML = `<svg class="w-4 h-4 text-gray-700 dark:text-gray-200 pointer-events-none" fill="currentColor" viewBox="0 0 24 24"><path d="${icons.delete}"/></svg>`;
            deleteBtn.onclick = (e) => {
                e.preventDefault(); e.stopPropagation();
                if (confirm(`Are you sure you want to delete this ${type}?`)) {
                    if (type === 'shortcut') {
                        const index = config.shortcuts.indexOf(item);
                        if (index > -1) config.shortcuts.splice(index, 1);
                        renderShortcuts();
                    } else {
                        const index = config.notes.indexOf(item);
                        if (index > -1) config.notes.splice(index, 1);
                        renderNotes();
                    }
                }
            };
            
            controlsContainer.appendChild(editBtn);
            controlsContainer.appendChild(deleteBtn);
            return controlsContainer;
        }
        
        function createShortcutElement(shortcut) {
            const container = document.createElement('div');
            container.className = 'relative group';

            const a = document.createElement('a');
            a.href = shortcut.url;
            a.target = '_blank';
            a.rel = 'noopener noreferrer';
            a.className = 'flex items-center gap-4 p-4 rounded-lg shadow-lg hover:shadow-cyan-500/10 hover:-translate-y-1 transition-all duration-300 text-gray-700 dark:text-gray-200 border border-gray-300/80 dark:border-gray-700/80 ' +
                          'bg-white/50 dark:bg-gray-800/50 hover:bg-gray-200/60 dark:hover:bg-gray-700/80 ' +
                          'style-compact:gap-2 style-compact:p-2 style-compact:text-sm style-compact:bg-white/60 style-compact:dark:bg-gray-800/60';

            if (shortcut.icon && icons[shortcut.icon]) {
                const iconContainer = document.createElement('div');
                iconContainer.className = 'flex-shrink-0 w-6 h-6 style-compact:w-5 style-compact:h-5';
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('viewBox', '0 0 24 24');
                svg.setAttribute('fill', 'currentColor');
                svg.className = 'text-gray-500 dark:text-gray-400 group-hover:text-black dark:group-hover:text-white transition-colors duration-300';
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', icons[shortcut.icon]);
                svg.appendChild(path);
                iconContainer.appendChild(svg);
                a.appendChild(iconContainer);
            }
            const textSpan = document.createElement('span');
            textSpan.textContent = shortcut.name;
            textSpan.className = 'font-semibold style-compact:font-normal';
            a.appendChild(textSpan);

            const previewBox = document.getElementById('link-preview');
            if (previewBox) {
                a.addEventListener('mouseenter', (event) => {
                    previewBox.textContent = shortcut.url;
                    const rect = event.currentTarget.getBoundingClientRect();
                    previewBox.style.top = `${rect.bottom + window.scrollY + 8}px`;
                    previewBox.style.left = `${rect.left + rect.width / 2}px`;
                    previewBox.style.transform = 'translateX(-50%)';
                    previewBox.classList.remove('opacity-0');
                });

                a.addEventListener('mouseleave', () => {
                    previewBox.classList.add('opacity-0');
                });
            }
            
            container.appendChild(a);
            container.appendChild(createItemControls(shortcut, 'shortcut'));
            return container;
        }

        // --- MAIN RENDER FUNCTIONS ---
        function renderShortcuts(query = '') {
            const mainContainer = document.getElementById('shortcuts-container');
            mainContainer.innerHTML = '';
            
            const lowerCaseQuery = query.toLowerCase();
            const filteredShortcuts = config.shortcuts.filter(shortcut => 
                shortcut.name.toLowerCase().includes(lowerCaseQuery) ||
                shortcut.category.toLowerCase().includes(lowerCaseQuery)
            );

            if (filteredShortcuts.length === 0) {
                const message = query ? `No results found for "${query}".` : 'No shortcuts configured.';
                mainContainer.innerHTML = `<p class="text-gray-500 dark:text-gray-400 p-4 text-center col-span-full">${message}</p>`;
                return;
            }

            const groupedByCategory = filteredShortcuts.reduce((groups, shortcut) => {
                const category = shortcut.category;
                if (!groups[category]) groups[category] = [];
                groups[category].push(shortcut);
                return groups;
            }, {});

            let delay = 0;
            for (const category in groupedByCategory) {
                const configData = categoryConfig[category] || { color: 'gray' };
                const colorClass = configData.color;
                const categoryWrapper = document.createElement('div');
                categoryWrapper.className = `p-5 rounded-xl border border-gray-300/80 dark:border-gray-700/80 bg-white/40 dark:bg-gray-800/40 backdrop-blur-sm shadow-2xl transition-all duration-300 style-compact:p-3 style-compact:rounded-lg style-compact:shadow-lg style-compact:bg-white/50 style-compact:dark:bg-gray-800/50`;
                categoryWrapper.style.animationDelay = `${delay}s`;
                delay += 0.1;

                const categoryHeader = document.createElement('div');
                categoryHeader.className = `flex items-center gap-3 mb-4 border-b-2 border-${colorClass}-500/50 pb-2 style-compact:gap-2 style-compact:mb-2 style-compact:pb-1 style-compact:border-b style-compact:border-${colorClass}-500/30`;
                const categoryColorDot = document.createElement('div');
                categoryColorDot.className = `w-3 h-3 rounded-full bg-${colorClass}-500 style-compact:w-2 style-compact:h-2`;
                const categoryTitle = document.createElement('h2');
                categoryTitle.textContent = category;
                categoryTitle.className = 'text-xl font-bold text-gray-800 dark:text-gray-200 style-compact:text-lg style-compact:font-semibold';
                
                categoryHeader.appendChild(categoryColorDot);
                categoryHeader.appendChild(categoryTitle);
                categoryWrapper.appendChild(categoryHeader);

                const linksGrid = document.createElement('div');
                linksGrid.className = 'grid grid-cols-1 sm:grid-cols-2 gap-3 style-compact:gap-2';
                groupedByCategory[category].forEach(shortcut => {
                    linksGrid.appendChild(createShortcutElement(shortcut));
                });
                categoryWrapper.appendChild(linksGrid);
                mainContainer.appendChild(categoryWrapper);
            }
        }

        function parseNoteContent(rawContent, isPreview = false) {
             const lines = rawContent.split('\\n'); // Use escaped newline
               let processedLines = [];
               let currentParagraph = [];
               let inList = false;

               const flushParagraph = () => {
                   if (currentParagraph.length > 0) {
                       processedLines.push(`<p class="text-gray-600 dark:text-gray-300 mb-2 style-compact:mb-1 style-compact:text-sm">${currentParagraph.join(' ').trim()}</p>`);
                       currentParagraph = [];
                   }
               };
            
               const closeList = () => {
                   if (inList) {
                       processedLines.push('</ul>');
                       inList = false;
                   }
               };

               lines.forEach(line => {
                   const headerMatch = line.match(/^(#{1,6})(.*?)\1?$/);
                   const listItemMatch = line.match(/^[\-\*]\s(.*)/);

                   if (headerMatch && headerMatch[2].trim() !== '') {
                       flushParagraph();
                       closeList();
                       const hashes = headerMatch[1];
                       const content = headerMatch[2];
                       const headingLevel = Math.min(hashes.length + 1, 6);
                       let classes = 'font-bold';
                       if (isPreview) {
                           classes += ' text-sm text-gray-500 dark:text-gray-400 mt-2 mb-1 style-compact:text-xs';
                       } else {
                           classes += ` text-sky-600 dark:text-sky-300 ${['text-2xl','text-xl','text-lg','text-base'][headingLevel-2] || 'text-base'} mb-2`;
                       }
                       processedLines.push(`<h${headingLevel} class="${classes}">${content.trim()}</h${headingLevel}>`);
                   } else if (listItemMatch) {
                       flushParagraph();
                       if (!inList) {
                           processedLines.push('<ul class="list-disc list-inside space-y-1 pl-2 mb-2 style-compact:text-sm">');
                           inList = true;
                       }
                       processedLines.push(`<li class="text-gray-600 dark:text-gray-300">${listItemMatch[1].trim()}</li>`);
                   } else if (line.trim() === '') {
                       flushParagraph();
                       closeList();
                   } else {
                       closeList();
                       currentParagraph.push(line);
                   }
               });

               flushParagraph();
               closeList();
               return processedLines.join('');
         }
        
        function renderNotes(query = '') {
            const notesContainer = document.getElementById('notes-container');
            const maxLines = 6;

            const lowerCaseQuery = query.toLowerCase();
            const filteredNotes = config.notes.filter(note =>
                query === '' ||
                (note.title && note.title.toLowerCase().includes(lowerCaseQuery)) ||
                note.content.toLowerCase().includes(lowerCaseQuery)
            );

            if (filteredNotes.length === 0) {
                const message = query ? `No notes found for "${query}".` : 'No notes available.';
                notesContainer.innerHTML = `<p class="text-gray-500 dark:text-gray-400 p-4 text-center col-span-full">${message}</p>`;
                return;
            }
            notesContainer.innerHTML = '';

            let delay = 0;
            filteredNotes.forEach(note => {
                const noteCard = document.createElement('div');
                noteCard.className = 'relative group p-5 rounded-xl border border-gray-300/80 dark:border-gray-700/80 bg-white/40 dark:bg-gray-800/40 backdrop-blur-sm shadow-2xl flex flex-col transition-all duration-300 ' +
                                         'style-compact:p-3 style-compact:rounded-lg style-compact:shadow-lg style-compact:bg-white/50 style-compact:dark:bg-gray-800/50';
                noteCard.style.animationDelay = `${delay}s`;
                delay += 0.1;

                if (note.title) {
                    const titleElement = document.createElement('h3');
                    titleElement.className = 'text-lg font-bold text-sky-600 dark:text-sky-300 mb-2 style-compact:text-base style-compact:mb-1';
                    titleElement.textContent = note.title;
                    noteCard.appendChild(titleElement);
                }

                const contentElement = document.createElement('div');
                contentElement.className = 'text-gray-600 dark:text-gray-300 whitespace-pre-wrap style-compact:text-sm';
                noteCard.appendChild(contentElement);
                
                const lines = note.content.split('\\n');
                const isTruncated = lines.length > maxLines;
                const previewContent = isTruncated ? lines.slice(0, maxLines).join('\\n') + '\\n...' : note.content;
                contentElement.innerHTML = parseNoteContent(previewContent, true);

                noteCard.appendChild(createItemControls(note, 'note'));

                if (isTruncated) {
                    const readMore = document.createElement('span');
                    readMore.textContent = 'Read more';
                    readMore.className = 'text-sky-600 dark:text-sky-400 hover:text-sky-500 dark:hover:text-sky-300 font-semibold mt-auto pt-2 cursor-pointer style-compact:text-xs style-compact:pt-1';
                    noteCard.appendChild(readMore);
                }
                noteCard.classList.add('cursor-pointer', 'hover:border-sky-500/50', 'dark:hover:border-sky-500/50', 'hover:-translate-y-1');
                noteCard.addEventListener('click', (e) => {
                    if (e.target.closest('button')) return; // Don't open view modal if clicking on edit/delete buttons
                    showNoteModal(note.title, parseNoteContent(note.content, false), note.content)
                });

                notesContainer.appendChild(noteCard);
            });
        }
        
        // --- MODAL & EDITING LOGIC ---
        function showNoteModal(title, htmlContent, rawContent) {
            const modal = document.getElementById('note-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            modalTitle.textContent = title || 'Note';
            modalTitle.style.display = title ? 'block' : 'none';
            modalBody.innerHTML = htmlContent;
            modal.classList.add('is-active');
            document.body.style.overflow = 'hidden';
            
            // Pass raw content to the copy button handler
            const copyBtn = document.getElementById('modal-copy-btn');
            copyBtn.dataset.rawContent = rawContent;
        }

        function hideNoteModal() {
            const modal = document.getElementById('note-modal');
            modal.classList.remove('is-active');
            document.body.style.overflow = '';
        }

        function setupModal() {
            const modal = document.getElementById('note-modal');
            const closeBtn = document.getElementById('modal-close-btn');
            const copyBtn = document.getElementById('modal-copy-btn');
            const copyBtnText = document.getElementById('copy-btn-text');
            const copyBtnIcon = document.getElementById('copy-btn-icon');
            const copyBtnSuccessIcon = document.getElementById('copy-btn-success-icon');

            if (!modal || !closeBtn || !copyBtn) return;
            
            closeBtn.addEventListener('click', hideNoteModal);
            copyBtn.addEventListener('click', (e) => {
                if (copyBtnText.textContent === 'Copied!') return;
                const rawContent = e.currentTarget.dataset.rawContent;
                navigator.clipboard.writeText(rawContent).then(() => {
                    copyBtnText.textContent = 'Copied!';
                    copyBtnIcon.classList.add('hidden');
                    copyBtnSuccessIcon.classList.remove('hidden');
                    setTimeout(() => {
                        copyBtnText.textContent = 'Copy';
                        copyBtnIcon.classList.remove('hidden');
                        copyBtnSuccessIcon.classList.add('hidden');
                    }, 2000);
                }).catch(err => console.error('Failed to copy text: ', err));
            });
            modal.addEventListener('click', (event) => {
                if (event.target === modal) hideNoteModal();
            });
        }
        
        // -- New Edit Modals --
        let editingShortcut = null;
        
        // ++ NEW FUNCTION ++
        // Renders clickable category tags inside the shortcut modal.
        function renderCategorySelector(container, hiddenInput, selectedCategory = '') {
            container.innerHTML = ''; // Clear any existing tags

            // Gather all unique categories from shortcuts and config
            const shortcutCategories = config.shortcuts.map(s => s.category);
            const configuredCategories = Object.keys(config.categoryConfig);
            const allCategories = [...new Set(['General', ...shortcutCategories, ...configuredCategories])].sort();

            allCategories.forEach(category => {
                const tag = document.createElement('button');
                tag.type = 'button'; // Prevent form submission
                tag.className = 'category-tag-btn'; // Class for styling
                tag.textContent = category;
                tag.dataset.category = category; // Store name in data attribute for the click handler

                if (category === selectedCategory) {
                    tag.classList.add('active');
                }
                container.appendChild(tag);
            });
            
            // Set the initial value of the hidden input
            hiddenInput.value = selectedCategory;
        }

        // ++ MODIFIED FUNCTION ++
        // Now populates the new category selector.
        function showShortcutModal(shortcut = null) {
            editingShortcut = shortcut;
            const modal = document.getElementById('edit-shortcut-modal');
            const title = document.getElementById('edit-shortcut-modal-title');
            const categoryContainer = document.getElementById('shortcut-category-selector');
            const categoryInput = document.getElementById('shortcut-category-input');

            if (shortcut) {
                title.textContent = 'Edit Shortcut';
                document.getElementById('shortcut-name-input').value = shortcut.name;
                document.getElementById('shortcut-url-input').value = shortcut.url;
                document.getElementById('shortcut-icon-input').value = shortcut.icon || '';
                // Render the tags with the current shortcut's category selected
                renderCategorySelector(categoryContainer, categoryInput, shortcut.category);
            } else {
                title.textContent = 'Add Shortcut';
                document.getElementById('edit-shortcut-form').reset();
                // Render the tags with 'General' selected for a new shortcut
                renderCategorySelector(categoryContainer, categoryInput, 'General');
            }
            
            modal.classList.add('is-active');
            document.body.style.overflow = 'hidden';
        }

        function hideShortcutModal() {
            const modal = document.getElementById('edit-shortcut-modal');
            modal.classList.remove('is-active');
            document.body.style.overflow = '';
            editingShortcut = null;
        }

        let editingNote = null;
        function showNoteEditModal(note = null) {
            editingNote = note;
            const modal = document.getElementById('edit-note-modal');
            const title = document.getElementById('edit-note-modal-title');

            if (note) {
                title.textContent = 'Edit Note';
                document.getElementById('note-title-input').value = note.title || '';
                // JSON uses '\\n' for newlines, textarea needs '\n'
                document.getElementById('note-content-input').value = note.content.replace(/\\n/g, '\n');
            } else {
                title.textContent = 'Add Note';
                document.getElementById('edit-note-form').reset();
            }
            
            modal.classList.add('is-active');
            document.body.style.overflow = 'hidden';
        }

        function hideNoteEditModal() {
            const modal = document.getElementById('edit-note-modal');
            modal.classList.remove('is-active');
            document.body.style.overflow = '';
            editingNote = null;
        }

        function setupEditing() {
            // Shortcut Modal
            document.getElementById('edit-shortcut-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const updatedShortcut = {
                    name: document.getElementById('shortcut-name-input').value,
                    url: document.getElementById('shortcut-url-input').value,
                    category: document.getElementById('shortcut-category-input').value, // Reads from the hidden input
                    icon: document.getElementById('shortcut-icon-input').value
                };

                if (editingShortcut) { // Edit mode
                    Object.assign(editingShortcut, updatedShortcut);
                } else { // Add mode
                    config.shortcuts.push(updatedShortcut);
                }
                hideShortcutModal();
                renderShortcuts(document.getElementById('search-input').value);
            });
            document.getElementById('edit-shortcut-modal').addEventListener('click', (e) => { if(e.target === e.currentTarget) hideShortcutModal() });
            document.getElementById('shortcut-modal-cancel').addEventListener('click', hideShortcutModal);
            
            // ++ NEW EVENT LISTENER ++
            // Handles clicks on the category tags using event delegation.
            document.getElementById('shortcut-category-selector').addEventListener('click', (e) => {
                const clickedTag = e.target.closest('.category-tag-btn');
                if (!clickedTag) return; // Exit if the click wasn't on a tag button

                // Update the hidden input's value with the clicked tag's category
                document.getElementById('shortcut-category-input').value = clickedTag.dataset.category;

                // Update the active state for visual feedback
                const container = clickedTag.parentElement;
                const currentActive = container.querySelector('.category-tag-btn.active');
                if (currentActive) {
                    currentActive.classList.remove('active');
                }
                clickedTag.classList.add('active');
            });


            // Note Modal
            document.getElementById('edit-note-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const updatedNote = {
                    title: document.getElementById('note-title-input').value,
                    // Textarea uses '\n', but for JSON string we need '\\n'
                    content: document.getElementById('note-content-input').value.replace(/\n/g, '\\n')
                };

                if (!updatedNote.title) delete updatedNote.title; // Remove title property if empty

                if (editingNote) { // Edit mode
                    Object.assign(editingNote, updatedNote);
                } else { // Add mode
                    config.notes.push(updatedNote);
                }
                hideNoteEditModal();
                renderNotes(document.getElementById('search-input').value);
            });
            document.getElementById('edit-note-modal').addEventListener('click', (e) => { if(e.target === e.currentTarget) hideNoteEditModal() });
            document.getElementById('note-modal-cancel').addEventListener('click', hideNoteEditModal);
            
            // "Add" buttons
            document.getElementById('add-shortcut-btn').addEventListener('click', () => showShortcutModal());
            document.getElementById('add-note-btn').addEventListener('click', () => showNoteEditModal());
        }

        // --- SETUP FUNCTIONS ---
        function setupAddButtonIcons() {
            const addShortcutBtn = document.getElementById('add-shortcut-btn');
            const addNoteBtn = document.getElementById('add-note-btn');

            const createIcon = (iconPath) => {
                const svgNS = 'http://www.w3.org/2000/svg';
                const svg = document.createElementNS(svgNS, 'svg');
                svg.setAttribute('class', 'w-4 h-4 text-sky-600 dark:text-sky-300');
                svg.setAttribute('fill', 'currentColor');
                svg.setAttribute('viewBox', '0 0 24 24');
                const path = document.createElementNS(svgNS, 'path');
                path.setAttribute('d', iconPath);
                svg.appendChild(path);
                return svg;
            }
            
            const addIcon = createIcon(icons.add);
            addShortcutBtn.prepend(addIcon.cloneNode(true));
            addNoteBtn.prepend(addIcon.cloneNode(true));
        }

        function setupSearch() {
            const searchInput = document.getElementById('search-input');
            const searchBox = document.getElementById('search-box');
            if (!searchInput) return;

            searchInput.addEventListener('keyup', (e) => {
                const query = e.target.value;
                const isShortcutsActive = document.getElementById('tab-shortcuts').classList.contains('active-tab');
                
                if (isShortcutsActive) {
                    renderShortcuts(query);
                } else {
                    renderNotes(query);
                }
            });
            
            searchInput.addEventListener('focus', () => searchBox.classList.add('border-sky-500'));
            searchInput.addEventListener('blur', () => searchBox.classList.remove('border-sky-500'));
        }

        function setupTabs() {
            const shortcutsTab = document.getElementById('tab-shortcuts');
            const notesTab = document.getElementById('tab-notes');
            const shortcutsContainer = document.getElementById('shortcuts-container');
            const notesContainer = document.getElementById('notes-container');
            const searchInput = document.getElementById('search-input');
            
            const addShortcutBtn = document.getElementById('add-shortcut-btn');
            const addNoteBtn = document.getElementById('add-note-btn');

            function updateTabState(activeTab) {
                const query = searchInput.value;
                if (activeTab === 'shortcuts') {
                    shortcutsTab.classList.add('active-tab');
                    notesTab.classList.remove('active-tab');
                    shortcutsContainer.classList.remove('hidden');
                    notesContainer.classList.add('hidden');
                    addShortcutBtn.classList.remove('hidden');
                    addNoteBtn.classList.add('hidden');
                    searchInput.placeholder = "Search shortcuts... (Press '/' to focus)";
                    renderShortcuts(query);
                } else {
                    notesTab.classList.add('active-tab');
                    shortcutsTab.classList.remove('active-tab');
                    notesContainer.classList.remove('hidden');
                    shortcutsContainer.classList.add('hidden');
                    addNoteBtn.classList.remove('hidden');
                    addShortcutBtn.classList.add('hidden');
                    searchInput.placeholder = "Search notes... (Press '/' to focus)";
                    renderNotes(query);
                }
            }
            
            // Set initial state
            updateTabState('shortcuts');

            shortcutsTab.addEventListener('click', () => updateTabState('shortcuts'));
            notesTab.addEventListener('click', () => updateTabState('notes'));
        }

        function setupThemeSwitcher() {
            const themeBtn = document.getElementById('theme-switcher');
            const sunIcon = document.getElementById('sun-icon');
            const moonIcon = document.getElementById('moon-icon');
            const applyTheme = (isDark) => {
                document.documentElement.classList.toggle('dark', isDark);
                sunIcon.classList.toggle('hidden', !isDark);
                moonIcon.classList.toggle('hidden', isDark);
            };
            themeBtn.addEventListener('click', () => {
                const isDarkMode = document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
                applyTheme(isDarkMode);
            });
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            applyTheme(savedTheme === 'dark' || (!savedTheme && systemPrefersDark));
        }

        function setupDisplayStyleSwitcher() {
            const styleBtn = document.getElementById('style-switcher');
            const styleText = document.getElementById('style-text');
            const container = document.querySelector('.container');
            const applyDisplayStyle = (isCompact) => {
                container.classList.toggle('style-compact', isCompact);
                styleText.textContent = isCompact ? 'Comfortable' : 'Compact';
                
                const currentQuery = document.getElementById('search-input').value;
                renderShortcuts(currentQuery);
                renderNotes(currentQuery);
            };
            styleBtn.addEventListener('click', () => {
                const isCompact = container.classList.toggle('style-compact');
                localStorage.setItem('displayStyle', isCompact ? 'compact' : 'comfortable');
                applyDisplayStyle(isCompact);
            });
            const savedDisplayStyle = localStorage.getItem('displayStyle');
            applyDisplayStyle(savedDisplayStyle === 'compact');
        }

        function setupConfigCopy() {
            const copyBtn = document.getElementById('copy-config-btn');
            const copyIcon = document.getElementById('config-copy-icon');
            const successIcon = document.getElementById('config-copy-success-icon');

            copyBtn.addEventListener('click', () => {
                // Ensure page title is updated in the config object before copying
                config.pageTitle = document.getElementById('page-title').textContent;

                const updatedConfigJson = JSON.stringify(config, null, 4);
                navigator.clipboard.writeText(updatedConfigJson).then(() => {
                    copyIcon.classList.add('hidden');
                    successIcon.classList.remove('hidden');
                    setTimeout(() => {
                        copyIcon.classList.remove('hidden');
                        successIcon.classList.add('hidden');
                    }, 2500);
                }).catch(err => {
                    alert('Failed to copy configuration.');
                    console.error('Failed to copy config: ', err);
                });
            });
        }


        // --- INITIALIZATION ---
        window.onload = function() {
            renderTitle();
            renderFavicon();
            renderGreeter();
            renderDate();
            renderClock();
            setInterval(renderClock, 1000);
            
            setupAddButtonIcons();
            setupThemeSwitcher();
            setupDisplayStyleSwitcher();
            setupSearch();
            setupTabs();
            setupModal();
            setupEditing();
            setupConfigCopy();

            window.addEventListener('keydown', (event) => {
                if (event.key === '/' && document.activeElement.tagName.toLowerCase() !== 'input' && document.activeElement.tagName.toLowerCase() !== 'textarea') {
                    event.preventDefault();
                    document.getElementById('search-input').focus();
                }
                if (event.key === 'Escape') {
                    if (document.getElementById('note-modal').classList.contains('is-active')) hideNoteModal();
                    if (document.getElementById('edit-shortcut-modal').classList.contains('is-active')) hideShortcutModal();
                    if (document.getElementById('edit-note-modal').classList.contains('is-active')) hideNoteEditModal();
                }
            });
        };
    </script>
    <style>
        .tab-button {
            cursor: pointer;
        }
        .tab-button.active-tab {
            border-color: #0ea5e9 !important; /* sky-500 */
            color: #0284c7 !important; /* sky-600 */
        }
        .dark .tab-button.active-tab {
            border-color: #38bdf8 !important; /* sky-400 */
            color: #38bdf8 !important; /* sky-400 */
        }
        .hidden {
            display: none !important;
        }

        /* Styles for edit modals and controls */
        .edit-modal {
            position: fixed; inset: 0;
            background-color: rgba(0,0,0,0.7);
            backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
            opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
        }
        .edit-modal.is-active {
            opacity: 1; visibility: visible;
        }
        .edit-modal-content {
            background-color: white;
            padding: 1.5rem 2rem;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 500px;
            transform: scale(0.95);
            transition: transform 0.3s;
        }
        .edit-modal.is-active .edit-modal-content {
            transform: scale(1);
        }
        .dark .edit-modal-content {
            background-color: #1f2937; /* dark:bg-gray-800 */
        }
        .form-field { margin-bottom: 1rem; }
        .form-field label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: #4a5568; }
        .dark .form-field label { color: #cbd5e0; }
        .form-field input, .form-field textarea {
            width: 100%;
            padding: 0.6rem 0.8rem;
            border-radius: 0.5rem;
            border: 1px solid #d1d5db; /* border-gray-300 */
            background-color: #f9fafb; /* bg-gray-50 */
            color: #1f2937; /* text-gray-800 */
        }
        .dark .form-field input, .dark .form-field textarea {
            border-color: #4b5563; /* dark:border-gray-600 */
            background-color: #374151; /* dark:bg-gray-700 */
            color: #f3f4f6; /* dark:text-gray-100 */
        }
        .form-field textarea { min-height: 120px; resize: vertical; }
        .form-actions { display: flex; justify-content: flex-end; gap: 0.75rem; margin-top: 1.5rem; }
        .btn { padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
        .btn-primary { background-color: #3b82f6; color: white; border: none; }
        .btn-primary:hover { background-color: #2563eb; }
        .btn-secondary { background-color: #e5e7eb; color: #1f2937; border: none; }
        .dark .btn-secondary { background-color: #4b5563; color: #f3f4f6; }
        .btn-secondary:hover { background-color: #d1d5db; }
        .dark .btn-secondary:hover { background-color: #6b7280; }

        /* ++ NEW STYLES for Category Selector ++ */
        .category-selector-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .category-tag-btn {
            padding: 0.375rem 0.875rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        /* Light mode tag styles */
        .category-tag-btn {
            background-color: #e5e7eb; /* gray-200 */
            color: #374151; /* gray-700 */
        }
        .category-tag-btn:hover {
            background-color: #d1d5db; /* gray-300 */
        }
        .category-tag-btn.active {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            font-weight: 600;
        }
        /* Dark mode tag styles (to match screenshot) */
        .dark .category-tag-btn {
            background-color: #4b5563; /* gray-600 */
            color: #e5e7eb; /* gray-200 */
        }
        .dark .category-tag-btn:hover {
            background-color: #6b7280; /* gray-500 */
        }
        .dark .category-tag-btn.active {
            background-color: #9ca3af; /* gray-400 */
            color: #1f2937; /* gray-800 */
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-white transition-colors duration-300">
    
    <div class="fixed top-4 right-4 flex space-x-2 z-50">
        <button id="copy-config-btn" class="p-2 rounded-full bg-gray-500/20 hover:bg-gray-500/40 backdrop-blur-sm transition-colors cursor-pointer" aria-label="Copy Configuration to Clipboard">
            <svg id="config-copy-icon" class="w-6 h-6 text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
            <svg id="config-copy-success-icon" class="w-6 h-6 text-green-500 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
        </button>

        <button id="theme-switcher" class="p-2 rounded-full bg-gray-500/20 hover:bg-gray-500/40 backdrop-blur-sm transition-colors cursor-pointer" aria-label="Toggle theme">
            <svg id="sun-icon" class="w-6 h-6 text-yellow-500 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
            <svg id="moon-icon" class="w-6 h-6 text-gray-200 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
        </button>

        <button id="style-switcher" class="p-2 rounded-full bg-gray-500/20 hover:bg-gray-500/40 backdrop-blur-sm transition-colors cursor-pointer" aria-label="Toggle display style">
            <span id="style-text" class="text-sm font-semibold">Compact</span>
        </button>
    </div>

    <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-white/10 via-white/0 to-indigo-100/20 dark:from-gray-900 dark:via-gray-900 dark:to-indigo-900/40 -z-10"></div>
    
    <div class="container mx-auto p-4 sm:p-6 lg:p-8 transition-all duration-300 style-compact:p-2 style-compact:sm:p-4 style-compact:lg:p-6">
        <div class="mb-8 style-compact:mb-4">
            <div class="flex items-baseline gap-4">
                <h1 id="page-title" class="text-4xl font-bold text-left fade-in style-compact:text-3xl"></h1>
                <div id="clock" class="text-xl font-mono text-gray-500 dark:text-gray-400 style-compact:text-lg"></div>
            </div>
            <p id="greeter" class="text-gray-500 dark:text-gray-400 fade-in"></p>
            <p id="date-display" class="text-gray-500 dark:text-gray-400 fade-in"></p>
        </div>

        <div class="mb-6 style-compact:mb-4">
            <div id="search-box" class="relative flex items-center p-1 rounded-xl border border-gray-300/80 dark:border-gray-700/80 bg-white/40 dark:bg-gray-800/40 backdrop-blur-sm shadow-lg transition-colors">
                <div class="w-10 h-10 flex items-center justify-center flex-shrink-0">
                    <svg class="w-6 h-6 text-gray-400 dark:text-gray-500" fill="currentColor" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
                </div>
                <input id="search-input" type="text" placeholder="Search shortcuts... (Press '/' to focus)" class="w-full bg-transparent p-2 text-gray-800 dark:text-gray-200 focus:outline-none">
            </div>
        </div>

        <div class="mb-4 flex items-center border-b border-gray-300/80 dark:border-gray-700/80">
            <button id="tab-shortcuts" class="tab-button px-4 py-2 text-sm font-semibold border-b-2 border-transparent transition-colors duration-300 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200">
                Shortcuts
            </button>
            <button id="tab-notes" class="tab-button px-4 py-2 text-sm font-semibold border-b-2 border-transparent transition-colors duration-300 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200">
                Notes
            </button>
            <div class="ml-auto">
                <button id="add-shortcut-btn" class="hidden cursor-pointer flex items-center gap-2 px-3 py-1.5 rounded-lg bg-sky-500/10 hover:bg-sky-500/20 dark:bg-sky-400/10 dark:hover:bg-sky-400/20 transition-colors">
                    <span class="text-sm font-semibold text-sky-700 dark:text-sky-200">Add Shortcut</span>
                </button>
                <button id="add-note-btn" class="hidden cursor-pointer flex items-center gap-2 px-3 py-1.5 rounded-lg bg-sky-500/10 hover:bg-sky-500/20 dark:bg-sky-400/10 dark:hover:bg-sky-400/20 transition-colors">
                    <span class="text-sm font-semibold text-sky-700 dark:text-sky-200">Add Note</span>
                </button>
            </div>
        </div>

        <div id="shortcuts-container" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3 mb-6 style-compact:gap-2 style-compact:mb-4"></div>
        <div id="notes-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 style-compact:gap-2"></div>
    </div>

    <div id="note-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 transition-opacity duration-300 opacity-0 invisible" style="backdrop-filter: blur(10px);">
        <div id="note-modal-content" class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] transform scale-95 opacity-0 transition-all duration-300 relative flex flex-col">
            <button id="modal-close-btn" class="absolute top-4 right-4 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white text-3xl leading-none z-10 cursor-pointer">×</button>
            <div class="flex-grow overflow-y-auto" style="scrollbar-width: thin; scrollbar-color: #6b7280 transparent;">
                <div class="p-8">
                    <h2 id="modal-title" class="text-2xl font-bold mb-4 text-gray-900 dark:text-white"></h2>
                    <div id="modal-body" class="text-gray-700 dark:text-gray-200 whitespace-pre-wrap"></div>
                </div>
            </div>
            <div class="flex-shrink-0 pt-4 pb-6 px-8 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                <button id="modal-copy-btn" class="flex items-center gap-2 px-4 py-2 rounded-md bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors cursor-pointer" aria-label="Copy content">
                    <span id="copy-btn-text" class="text-sm font-medium text-gray-700 dark:text-gray-200">Copy</span>
                    <svg id="copy-btn-icon" class="w-5 h-5 text-gray-500 dark:text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    <svg id="copy-btn-success-icon" class="w-5 h-5 text-green-500 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <div id="edit-shortcut-modal" class="edit-modal">
        <div class="edit-modal-content">
            <h2 id="edit-shortcut-modal-title" class="text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100"></h2>
            <form id="edit-shortcut-form">
                <div class="form-field">
                    <label for="shortcut-name-input">Name</label>
                    <input id="shortcut-name-input" type="text" required>
                </div>
                <div class="form-field">
                    <label for="shortcut-url-input">URL</label>
                    <input id="shortcut-url-input" type="url" required>
                </div>
                <div class="form-field">
                    <label for="shortcut-category-input">Category</label>
                    <div id="shortcut-category-selector" class="category-selector-container"></div>
                    <input id="shortcut-category-input" type="hidden" required>
                </div>
                <div class="form-field">
                    <label for="shortcut-icon-input">Icon Name</label>
                    <input id="shortcut-icon-input" type="text" placeholder="e.g., 'google' (optional)">
                </div>
                <div class="form-actions">
                    <button type="button" id="shortcut-modal-cancel" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="edit-note-modal" class="edit-modal">
        <div class="edit-modal-content">
            <h2 id="edit-note-modal-title" class="text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100"></h2>
            <form id="edit-note-form">
                <div class="form-field">
                    <label for="note-title-input">Title (Optional)</label>
                    <input id="note-title-input" type="text">
                </div>
                <div class="form-field">
                    <label for="note-content-input">Content</label>
                    <textarea id="note-content-input" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" id="note-modal-cancel" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <div id="link-preview" class="fixed pointer-events-none z-50 rounded-lg bg-gray-800 px-3 py-1.5 text-sm font-medium text-white shadow-lg transition-opacity duration-200 opacity-0" role="tooltip"></div>
</body>
</html>